# 衛星画像と深層学習を活用した広域・多時期の斜面崩壊地分布図作成

## 概要 / Overview

- 本プロジェクトは、**日本全域における斜面崩壊地の分布図作成**を最終目的としています。
- 複数の斜面崩壊事例を用いて、U-Netモデルを学習し、**崩壊地or非崩壊地の2カテゴリ**に分類します。
  
---
## スクリプト / Script

| ① unet_trial_番号.py | ② unet_model_番号.h5 | ③ unet_validation_番号.py |
|-----|-----|-----|
| U-Netモデルの定義、学習、モデル出力 | 出力されたモデル | 未学習画像によるモデルの検証 |

| 番号 | 使用モデル | 特徴量 | 学習データ | 学習枚数 | 学習ログ | 評価 | 
|-----|-----|-----|-----|-----|-----|-----|
| 無印 | | Planet 4バンド | | | | エラーで動かず |
| 02 | モデルA (下記) | Planet 4バンド (正規化なし) |崩壊地:非崩壊地 = **2:8** を超える偏りのあるタイルは除外| | | 動いた (精度はまだまだ) |
| 03 | モデルA (下記) | Planet 4バンド (10,000で除算し正規化) |崩壊地:非崩壊地 = **2:8** を超える偏りのあるタイルは除外| | Epoch 1/10 - accuracy: 0.5626 - loss: 2.3935 - val_accuracy: 0.6989 - val_loss: 0.6538 Epoch 6/10 - accuracy: 0.6262 - loss: 1.2418 - val_accuracy: 0.6989 - val_loss: 0.7909 | 特徴量を正規化しても動いた (02番では正規化を忘れていた)。正確に崩壊地を抽出しているとは言えないが、何らかの学習が行われていそうなのでgood |
| 04 | モデルA (下記) | Planet (÷10,000) + DEM (÷ 1,500) + Slope (÷90) | 崩壊地:非崩壊地 = **2:8** を超える偏りのあるタイルは除外 | | | |

---
## モデル

- モデルA
  - モデル構造：縮小・拡大パスを持つ簡易UNet（3層エンコーダ＋3層デコーダ）
  - 入力データ：128×128ピクセル、4バンド（RGB + NIR）
  - 出力形式：128×128ピクセル、2クラス（softmax出力）
  - マスク前処理：崩壊地＝1、非崩壊地＝0としてone-hotエンコード
  - 損失関数：categorical_crossentropy（クラス重みあり）
  - 最適化手法：Adam（学習率1e-5）
  - 重み付け：崩壊地=5.0、非崩壊地=1.0のsample_weightを使用
  - 学習設定：エポック数10、バッチサイズ16、EarlyStopping適用（patience=5）

---

## 使用データ / Data Used

### 特徴量作成用
- **衛星画像**：PlanetScope（3m解像度）
- **標高データ**：基盤地図情報 数値標高モデル [GSI 地理院地図](https://service.gsi.go.jp/kiban/)

### マスク作成用
- **崩壊地判読図**：国土地理院 防災・災害対応ページより取得 [GSI 防災・災害対応](https://www.gsi.go.jp/bousai.html)

### 使用事例
| 年度 | 災害名 | 地域 |
|------|--------|------|
| H29  | 九州北部豪雨         | 福岡県 赤谷川 |
| H30  | 北海道胆振東部地震   | 北海道 胆振地方 |
| R01  | 台風19号豪雨         | 宮城県 五福谷川 |
| R06  | 能登半島地震         | 石川県 能登地方 |
| R06  | 能登半島豪雨         | 石川県 能登地方 |

※ 衛星画像は全て、`128 pixel × 128 pixel` のタイルに分割。  
  
---

## ディレクトリ構成 / Dataset Structure

- dataset/
  - train/     
    - images/
    - masks/
  - val/               
    - images/
    - masks/
  - test/
    - images/
    - masks/
